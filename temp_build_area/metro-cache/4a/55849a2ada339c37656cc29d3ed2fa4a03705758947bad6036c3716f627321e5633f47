{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":30,"index":30}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}},{"name":"../constants/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":32},"end":{"line":2,"column":49,"index":81}}],"key":"ZV0ujAFjHVGmM4aJSYIlDaiTRjE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"messageService\", {\n    enumerable: true,\n    get: function () {\n      return messageService;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _api = require(_dependencyMap[1], \"./api\");\n  var apiClient = _interopDefault(_api);\n  var _constantsApi = require(_dependencyMap[2], \"../constants/api\");\n  var messageService = {\n    getConversations() {\n      return (0, _asyncToGenerator.default)(function* () {\n        try {\n          var response = yield apiClient.default.get(_constantsApi.API_ENDPOINTS.CONVERSATIONS || '/conversations');\n          return response.data.data?.conversations || [];\n        } catch (error) {\n          // Backend endpoint henüz hazır değilse boş liste döndür\n          if (error?.response?.status === 404) {\n            return [];\n          }\n          throw error;\n        }\n      })();\n    },\n    getConversation(conversationId) {\n      return (0, _asyncToGenerator.default)(function* () {\n        if (!conversationId) return null;\n        var response = yield apiClient.default.get(_constantsApi.API_ENDPOINTS.CONVERSATION_DETAIL(conversationId));\n        return response.data.data?.conversation;\n      })();\n    },\n    findConversation(recipientId, jobId) {\n      return (0, _asyncToGenerator.default)(function* () {\n        try {\n          var response = yield apiClient.default.get(`${_constantsApi.API_ENDPOINTS.CONVERSATIONS}/find`, {\n            params: {\n              recipientId,\n              jobId\n            }\n          });\n          return response.data.data?.conversation;\n        } catch (error) {\n          if (error.response?.status === 404) return null;\n          throw error;\n        }\n      })();\n    },\n    findOrCreateConversation(recipientId, jobId) {\n      var _this = this;\n      return (0, _asyncToGenerator.default)(function* () {\n        try {\n          // Önce mevcut konuşmayı ara\n          var existing = yield _this.findConversation(recipientId, jobId);\n          if (existing) {\n            return existing;\n          }\n\n          // Bulunamadıysa yeni konuşma oluştur\n          var createRes = yield apiClient.default.post(_constantsApi.API_ENDPOINTS.CONVERSATIONS, {\n            recipientId: recipientId,\n            jobPostId: jobId\n          });\n          return createRes.data.data?.conversation || null;\n        } catch (error) {\n          console.error('findOrCreateConversation error:', error);\n          return null;\n        }\n      })();\n    },\n    getMessages(conversationId) {\n      return (0, _asyncToGenerator.default)(function* () {\n        if (!conversationId) return [];\n        var response = yield apiClient.default.get(_constantsApi.API_ENDPOINTS.MESSAGES(conversationId));\n        return response.data.data?.messages || [];\n      })();\n    },\n    sendMessage(data) {\n      return (0, _asyncToGenerator.default)(function* () {\n        // Mesaj gönderme endpointi güncellendi: /conversations/:id/messages\n        // Ancak yeni konuşma başlatırken conversationId olmayabilir.\n        // Bu durumda backend'e özel bir endpoint gerekebilir veya /conversations post edilip sonra mesaj atılır.\n        // Şimdilik existing /messages endpointi varsa onu kullanalım, yoksa conversatin create edip atalım.\n\n        // Backend'de POST /conversations/:id/messages var.\n        // Eğer conversationId yoksa önce oluşturup sonra mesaj atmalıyız.\n\n        // NOTE: Backend'de genel bir POST /messages endpointi olmayabilir.\n        // createConversation -> sendMessage akışı daha doğru.\n\n        // Geçici olarak create logic'i buraya ekleyelim:\n        var convId = '';\n        try {\n          var existing = yield messageService.findConversation(data.receiverId, data.jobId);\n          if (existing) {\n            convId = existing.id;\n          } else {\n            // Create new\n            var createRes = yield apiClient.default.post(_constantsApi.API_ENDPOINTS.CONVERSATIONS, {\n              recipientId: data.receiverId,\n              jobPostId: data.jobId\n            });\n            convId = createRes.data.data.conversation.id;\n          }\n          var response = yield apiClient.default.post(apiClient.default.defaults.baseURL + `conversations/${convId}/messages`, {\n            content: data.content\n          });\n          return response.data.data?.message;\n        } catch (e) {\n          console.error(\"Message send failed:\", e);\n          throw e;\n        }\n      })();\n    },\n    markAsRead(conversationId) {\n      return (0, _asyncToGenerator.default)(function* () {\n        var response = yield apiClient.default.put(_constantsApi.API_ENDPOINTS.MARK_CONVERSATION_READ(conversationId));\n        return response.data.data;\n      })();\n    }\n  };\n});","lineCount":134,"map":[[12,2,56,0,"Object"],[12,8,56,0],[12,9,56,0,"defineProperty"],[12,23,56,0],[12,24,56,0,"exports"],[12,31,56,0],[13,4,56,0,"enumerable"],[13,14,56,0],[14,4,56,0,"get"],[14,7,56,0],[14,18,56,0,"get"],[14,19,56,0],[15,6,56,0],[15,13,56,0,"messageService"],[15,27,56,0],[16,4,56,0],[17,2,56,0],[18,2,160,2],[18,6,160,2,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,160,2],[18,45,160,2,"require"],[18,52,160,2],[18,53,160,2,"_dependencyMap"],[18,67,160,2],[19,2,160,2],[19,6,160,2,"_asyncToGenerator"],[19,23,160,2],[19,26,160,2,"_interopDefault"],[19,41,160,2],[19,42,160,2,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,160,2],[20,2,1,0],[20,6,1,0,"_api"],[20,10,1,0],[20,13,1,0,"require"],[20,20,1,0],[20,21,1,0,"_dependencyMap"],[20,35,1,0],[21,2,1,0],[21,6,1,0,"apiClient"],[21,15,1,0],[21,18,1,0,"_interopDefault"],[21,33,1,0],[21,34,1,0,"_api"],[21,38,1,0],[22,2,2,0],[22,6,2,0,"_constantsApi"],[22,19,2,0],[22,22,2,0,"require"],[22,29,2,0],[22,30,2,0,"_dependencyMap"],[22,44,2,0],[23,2,56,7],[23,6,56,13,"messageService"],[23,20,56,27],[23,23,56,30],[24,4,57,8,"getConversations"],[24,20,57,24,"getConversations"],[24,21,57,24],[24,23,57,27],[25,6,57,27],[25,17,57,27,"_asyncToGenerator"],[25,34,57,27],[25,35,57,27,"default"],[25,42,57,27],[26,8,58,4],[26,12,58,8],[27,10,59,6],[27,14,59,12,"response"],[27,22,59,20],[27,31,59,29,"apiClient"],[27,40,59,38],[27,41,59,38,"default"],[27,48,59,38],[27,49,59,39,"get"],[27,52,59,42],[27,53,59,43,"API_ENDPOINTS"],[27,66,59,56],[27,67,59,56,"API_ENDPOINTS"],[27,80,59,56],[27,81,59,57,"CONVERSATIONS"],[27,94,59,70],[27,98,59,74],[27,114,59,90],[27,115,59,91],[28,10,60,6],[28,17,60,13,"response"],[28,25,60,21],[28,26,60,22,"data"],[28,30,60,26],[28,31,60,27,"data"],[28,35,60,31],[28,37,60,33,"conversations"],[28,50,60,46],[28,54,60,50],[28,56,60,52],[29,8,61,4],[29,9,61,5],[29,10,61,6],[29,17,61,13,"error"],[29,22,61,23],[29,24,61,25],[30,10,62,6],[31,10,63,6],[31,14,63,10,"error"],[31,19,63,15],[31,21,63,17,"response"],[31,29,63,25],[31,31,63,27,"status"],[31,37,63,33],[31,42,63,38],[31,45,63,41],[31,47,63,43],[32,12,64,8],[32,19,64,15],[32,21,64,17],[33,10,65,6],[34,10,66,6],[34,16,66,12,"error"],[34,21,66,17],[35,8,67,4],[36,6,67,5],[37,4,68,2],[37,5,68,3],[38,4,70,8,"getConversation"],[38,19,70,23,"getConversation"],[38,20,70,24,"conversationId"],[38,34,70,46],[38,36,70,48],[39,6,70,48],[39,17,70,48,"_asyncToGenerator"],[39,34,70,48],[39,35,70,48,"default"],[39,42,70,48],[40,8,71,4],[40,12,71,8],[40,13,71,9,"conversationId"],[40,27,71,23],[40,29,71,25],[40,36,71,32],[40,40,71,36],[41,8,72,4],[41,12,72,10,"response"],[41,20,72,18],[41,29,72,27,"apiClient"],[41,38,72,36],[41,39,72,36,"default"],[41,46,72,36],[41,47,72,37,"get"],[41,50,72,40],[41,51,72,41,"API_ENDPOINTS"],[41,64,72,54],[41,65,72,54,"API_ENDPOINTS"],[41,78,72,54],[41,79,72,55,"CONVERSATION_DETAIL"],[41,98,72,74],[41,99,72,75,"conversationId"],[41,113,72,89],[41,114,72,90],[41,115,72,91],[42,8,73,4],[42,15,73,11,"response"],[42,23,73,19],[42,24,73,20,"data"],[42,28,73,24],[42,29,73,25,"data"],[42,33,73,29],[42,35,73,31,"conversation"],[42,47,73,43],[43,6,73,44],[44,4,74,2],[44,5,74,3],[45,4,76,8,"findConversation"],[45,20,76,24,"findConversation"],[45,21,76,25,"recipientId"],[45,32,76,44],[45,34,76,46,"jobId"],[45,39,76,60],[45,41,76,62],[46,6,76,62],[46,17,76,62,"_asyncToGenerator"],[46,34,76,62],[46,35,76,62,"default"],[46,42,76,62],[47,8,77,4],[47,12,77,8],[48,10,78,6],[48,14,78,12,"response"],[48,22,78,20],[48,31,78,29,"apiClient"],[48,40,78,38],[48,41,78,38,"default"],[48,48,78,38],[48,49,78,39,"get"],[48,52,78,42],[48,53,78,43],[48,56,78,46,"API_ENDPOINTS"],[48,69,78,59],[48,70,78,59,"API_ENDPOINTS"],[48,83,78,59],[48,84,78,60,"CONVERSATIONS"],[48,97,78,73],[48,104,78,80],[48,106,78,82],[49,12,79,8,"params"],[49,18,79,14],[49,20,79,16],[50,14,79,18,"recipientId"],[50,25,79,29],[51,14,79,31,"jobId"],[52,12,79,37],[53,10,80,6],[53,11,80,7],[53,12,80,8],[54,10,81,6],[54,17,81,13,"response"],[54,25,81,21],[54,26,81,22,"data"],[54,30,81,26],[54,31,81,27,"data"],[54,35,81,31],[54,37,81,33,"conversation"],[54,49,81,45],[55,8,82,4],[55,9,82,5],[55,10,82,6],[55,17,82,13,"error"],[55,22,82,23],[55,24,82,25],[56,10,83,6],[56,14,83,10,"error"],[56,19,83,15],[56,20,83,16,"response"],[56,28,83,24],[56,30,83,26,"status"],[56,36,83,32],[56,41,83,37],[56,44,83,40],[56,46,83,42],[56,53,83,49],[56,57,83,53],[57,10,84,6],[57,16,84,12,"error"],[57,21,84,17],[58,8,85,4],[59,6,85,5],[60,4,86,2],[60,5,86,3],[61,4,88,8,"findOrCreateConversation"],[61,28,88,32,"findOrCreateConversation"],[61,29,88,33,"recipientId"],[61,40,88,52],[61,42,88,54,"jobId"],[61,47,88,68],[61,49,88,100],[62,6,88,100],[62,10,88,100,"_this"],[62,15,88,100],[63,6,88,100],[63,17,88,100,"_asyncToGenerator"],[63,34,88,100],[63,35,88,100,"default"],[63,42,88,100],[64,8,89,4],[64,12,89,8],[65,10,90,6],[66,10,91,6],[66,14,91,12,"existing"],[66,22,91,20],[66,31,91,29,"_this"],[66,36,91,33],[66,37,91,34,"findConversation"],[66,53,91,50],[66,54,91,51,"recipientId"],[66,65,91,62],[66,67,91,64,"jobId"],[66,72,91,69],[66,73,91,70],[67,10,92,6],[67,14,92,10,"existing"],[67,22,92,18],[67,24,92,20],[68,12,93,8],[68,19,93,15,"existing"],[68,27,93,23],[69,10,94,6],[71,10,96,6],[72,10,97,6],[72,14,97,12,"createRes"],[72,23,97,21],[72,32,97,30,"apiClient"],[72,41,97,39],[72,42,97,39,"default"],[72,49,97,39],[72,50,97,40,"post"],[72,54,97,44],[72,55,97,45,"API_ENDPOINTS"],[72,68,97,58],[72,69,97,58,"API_ENDPOINTS"],[72,82,97,58],[72,83,97,59,"CONVERSATIONS"],[72,96,97,72],[72,98,97,74],[73,12,98,8,"recipientId"],[73,23,98,19],[73,25,98,21,"recipientId"],[73,36,98,32],[74,12,99,8,"jobPostId"],[74,21,99,17],[74,23,99,19,"jobId"],[75,10,100,6],[75,11,100,7],[75,12,100,8],[76,10,101,6],[76,17,101,13,"createRes"],[76,26,101,22],[76,27,101,23,"data"],[76,31,101,27],[76,32,101,28,"data"],[76,36,101,32],[76,38,101,34,"conversation"],[76,50,101,46],[76,54,101,50],[76,58,101,54],[77,8,102,4],[77,9,102,5],[77,10,102,6],[77,17,102,13,"error"],[77,22,102,23],[77,24,102,25],[78,10,103,6,"console"],[78,17,103,13],[78,18,103,14,"error"],[78,23,103,19],[78,24,103,20],[78,57,103,53],[78,59,103,55,"error"],[78,64,103,60],[78,65,103,61],[79,10,104,6],[79,17,104,13],[79,21,104,17],[80,8,105,4],[81,6,105,5],[82,4,106,2],[82,5,106,3],[83,4,108,8,"getMessages"],[83,15,108,19,"getMessages"],[83,16,108,20,"conversationId"],[83,30,108,42],[83,32,108,44],[84,6,108,44],[84,17,108,44,"_asyncToGenerator"],[84,34,108,44],[84,35,108,44,"default"],[84,42,108,44],[85,8,109,4],[85,12,109,8],[85,13,109,9,"conversationId"],[85,27,109,23],[85,29,109,25],[85,36,109,32],[85,38,109,34],[86,8,110,4],[86,12,110,10,"response"],[86,20,110,18],[86,29,110,27,"apiClient"],[86,38,110,36],[86,39,110,36,"default"],[86,46,110,36],[86,47,110,37,"get"],[86,50,110,40],[86,51,110,41,"API_ENDPOINTS"],[86,64,110,54],[86,65,110,54,"API_ENDPOINTS"],[86,78,110,54],[86,79,110,55,"MESSAGES"],[86,87,110,63],[86,88,110,64,"conversationId"],[86,102,110,78],[86,103,110,79],[86,104,110,80],[87,8,111,4],[87,15,111,11,"response"],[87,23,111,19],[87,24,111,20,"data"],[87,28,111,24],[87,29,111,25,"data"],[87,33,111,29],[87,35,111,31,"messages"],[87,43,111,39],[87,47,111,43],[87,49,111,45],[88,6,111,46],[89,4,112,2],[89,5,112,3],[90,4,114,8,"sendMessage"],[90,15,114,19,"sendMessage"],[90,16,114,20,"data"],[90,20,114,43],[90,22,114,45],[91,6,114,45],[91,17,114,45,"_asyncToGenerator"],[91,34,114,45],[91,35,114,45,"default"],[91,42,114,45],[92,8,115,4],[93,8,116,4],[94,8,117,4],[95,8,118,4],[97,8,120,4],[98,8,121,4],[100,8,123,4],[101,8,124,4],[103,8,126,4],[104,8,127,4],[104,12,127,8,"convId"],[104,18,127,14],[104,21,127,17],[104,23,127,19],[105,8,129,4],[105,12,129,8],[106,10,130,6],[106,14,130,12,"existing"],[106,22,130,20],[106,31,130,29,"messageService"],[106,45,130,43],[106,46,130,44,"findConversation"],[106,62,130,60],[106,63,130,61,"data"],[106,67,130,65],[106,68,130,66,"receiverId"],[106,78,130,76],[106,80,130,78,"data"],[106,84,130,82],[106,85,130,83,"jobId"],[106,90,130,88],[106,91,130,89],[107,10,131,6],[107,14,131,10,"existing"],[107,22,131,18],[107,24,131,20],[108,12,132,8,"convId"],[108,18,132,14],[108,21,132,17,"existing"],[108,29,132,25],[108,30,132,26,"id"],[108,32,132,28],[109,10,133,6],[109,11,133,7],[109,17,133,13],[110,12,134,8],[111,12,135,8],[111,16,135,14,"createRes"],[111,25,135,23],[111,34,135,32,"apiClient"],[111,43,135,41],[111,44,135,41,"default"],[111,51,135,41],[111,52,135,42,"post"],[111,56,135,46],[111,57,135,47,"API_ENDPOINTS"],[111,70,135,60],[111,71,135,60,"API_ENDPOINTS"],[111,84,135,60],[111,85,135,61,"CONVERSATIONS"],[111,98,135,74],[111,100,135,76],[112,14,136,10,"recipientId"],[112,25,136,21],[112,27,136,23,"data"],[112,31,136,27],[112,32,136,28,"receiverId"],[112,42,136,38],[113,14,137,10,"jobPostId"],[113,23,137,19],[113,25,137,21,"data"],[113,29,137,25],[113,30,137,26,"jobId"],[114,12,138,8],[114,13,138,9],[114,14,138,10],[115,12,139,8,"convId"],[115,18,139,14],[115,21,139,17,"createRes"],[115,30,139,26],[115,31,139,27,"data"],[115,35,139,31],[115,36,139,32,"data"],[115,40,139,36],[115,41,139,37,"conversation"],[115,53,139,49],[115,54,139,50,"id"],[115,56,139,52],[116,10,140,6],[117,10,142,6],[117,14,142,12,"response"],[117,22,142,20],[117,31,142,29,"apiClient"],[117,40,142,38],[117,41,142,38,"default"],[117,48,142,38],[117,49,142,39,"post"],[117,53,142,43],[117,54,143,8,"apiClient"],[117,63,143,17],[117,64,143,17,"default"],[117,71,143,17],[117,72,143,18,"defaults"],[117,80,143,26],[117,81,143,27,"baseURL"],[117,88,143,34],[117,91,143,37],[117,108,143,54,"convId"],[117,114,143,60],[117,125,143,71],[117,127,144,8],[118,12,144,10,"content"],[118,19,144,17],[118,21,144,19,"data"],[118,25,144,23],[118,26,144,24,"content"],[119,10,144,32],[119,11,145,6],[119,12,145,7],[120,10,146,6],[120,17,146,13,"response"],[120,25,146,21],[120,26,146,22,"data"],[120,30,146,26],[120,31,146,27,"data"],[120,35,146,31],[120,37,146,33,"message"],[120,44,146,40],[121,8,148,4],[121,9,148,5],[121,10,148,6],[121,17,148,13,"e"],[121,18,148,14],[121,20,148,16],[122,10,149,6,"console"],[122,17,149,13],[122,18,149,14,"error"],[122,23,149,19],[122,24,149,20],[122,46,149,42],[122,48,149,44,"e"],[122,49,149,45],[122,50,149,46],[123,10,150,6],[123,16,150,12,"e"],[123,17,150,13],[124,8,151,4],[125,6,151,5],[126,4,152,2],[126,5,152,3],[127,4,154,8,"markAsRead"],[127,14,154,18,"markAsRead"],[127,15,154,19,"conversationId"],[127,29,154,41],[127,31,154,43],[128,6,154,43],[128,17,154,43,"_asyncToGenerator"],[128,34,154,43],[128,35,154,43,"default"],[128,42,154,43],[129,8,155,4],[129,12,155,10,"response"],[129,20,155,18],[129,29,155,27,"apiClient"],[129,38,155,36],[129,39,155,36,"default"],[129,46,155,36],[129,47,155,37,"put"],[129,50,155,40],[129,51,156,6,"API_ENDPOINTS"],[129,64,156,19],[129,65,156,19,"API_ENDPOINTS"],[129,78,156,19],[129,79,156,20,"MARK_CONVERSATION_READ"],[129,101,156,42],[129,102,156,43,"conversationId"],[129,116,156,57],[129,117,157,4],[129,118,157,5],[130,8,158,4],[130,15,158,11,"response"],[130,23,158,19],[130,24,158,20,"data"],[130,28,158,24],[130,29,158,25,"data"],[130,33,158,29],[131,6,158,30],[132,4,159,2],[133,2,160,0],[133,3,160,1],[134,0,160,2],[134,3]],"functionMap":{"names":["<global>","getConversations","getConversation","findConversation","findOrCreateConversation","getMessages","sendMessage","markAsRead"],"mappings":"AAA;ECwD;GDW;EEE;GFI;EGE;GHU;EIE;GJkB;EKE;GLI;EME;GNsC;EOE;GPK"},"hasCjsExports":false},"type":"js/module"}]}